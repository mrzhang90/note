##微信分享
url参数
单页面下router的mode默认为hash，那么url参数为location.href('#')
多页面或单页面下router设为history,那么url默认参数为location.href
```js
// 获取微信配置
function getWXSDK(){
    return new Promise((resolve,reject)=>{
        //必须传入当前完整url,但是当mode为hash的单页面，用location.href('#')[0]截掉#，因为微信会忽略#，你要是不截掉#,分享配置会失败
        apiGetJsSdk({'url': location.href}).then(result=>{
            // 微信配置
            wx.config(result.data)
            resolve();
        }).catch((err)=>{
            reject(err)
        })
    })
}
// 得到：
// {
//     "debug": false,
//     "beta": false,
//     "jsApiList": [
//         "chooseWXPay",
//         "onMenuShareTimeline",
//         "onMenuShareAppMessage",
//         "startRecord",
//         "stopRecord",
//         "onVoiceRecordEnd",
//         "playVoice",
//         "pauseVoice",
//         "stopVoice",
//         "onVoicePlayEnd",
//         "uploadVoice",
//         "downloadVoice",
//         "translateVoice"
//     ],
//     "appId": "******",
//     "nonceStr": "UzSnGDr2kC",
//     "timestamp": 1542875252,
//     "url": "http://localhost:8081/",
//     "signature": "******"
// }
// 微信分享配置
export function share_unclock(parames){
    getWXSDK().then(()=>{
        // 配置分享
        ready().then(()=>{
            var obj={
                title: '贝壳亲子英语儿歌体验课', // 分享标题
                desc: '我和宝宝正在贝壳学习英语，推荐你来加入哦！',
                link: base,
                imgUrl: 'http://qiniu.bkenglish.cn/wetchat/server/share/img/wechat_video_share_20180803151428.png' // 分享图标
            }
            typeof parames=="object" && Object.assign(obj,parames);
            // 获取"分享给朋友"按钮点击状态及自定义分享内容接口
            wx.onMenuShareAppMessage(obj);
            
            // 获取"分享到朋友圈"按钮点击状态及自定义分享内容接口
            wx.onMenuShareTimeline(obj);
        })
    }).catch((err)=>{
        console.log(err)
    })
}
```
调用
```js
import {
  //微信分享配置
  share_unclock
} from "../../common/wx";
share_unclock({
  title:'hello world'
})
```
##axios取消多次重复请求
[参考1.](https://segmentfault.com/q/1010000014258001/a-1020000014258110)
[参考2.](https://www.jianshu.com/p/4445595488e2)
[参考3.](https://blog.csdn.net/qq_39197547/article/details/81909041)
```js
// api.js - 存入记录请求值，不同的接口不同的请求值
// requestName - 是在取消重复接口时用的记录值
export const apiGetJsSdk = (parames) => request.get('/api/h5/get/js_sdk', Object.assign({},parames,{requestName:'jssdk'}));
```
```js
// http.js - 在拦截器判断有没有自定义的请求值
// axios取消重复请求
let CancelToken = axios.CancelToken;
//拦截器
axios.interceptors.request.use(
  config => {
    //post和get请求方式的不同
    let requestName = config.method === 'post' ? config.data.requestName : config.params.requestName
    if (requestName) {
      // 第一次cancel是空的，不会触发
      if (axios[requestName] && axios[requestName].cancel) {
        // 取消请求
        axios[requestName].cancel()
      }
      config.cancelToken = new CancelToken(c => {
        axios[requestName] = {}
        // 存储cancel值，多次调用同一个接口，会触发
        axios[requestName].cancel = c
      })
    }
    return config;
  },
)
```
##解决微信公众号内，播放器被拦截的问题
x5-playsinline="true"是最重要的一句，解决安卓下video播放器被微信拦截
webkit-playsinline和playsinline也是解决安卓和IOS下播放器被拦截的问题
```html
<video 
    :src="videoAddress"
    :poster="videoAddress+'?vframe/jpg/offset/0'"
    width="100%" height="100%"
    controls="" 
    preload="auto"
    webkit-playsinline="true" 
    x-webkit-airplay="true" 
    playsinline="true" 
    x5-video-orientation="h5"
    x5-playsinline="true"
    style="display: inline;">
        您的浏览器不支持。
    </video>
```
##单页面下-IOS下-微信支付报错-URL错误
错误场景：通过微信分享链接进入H5页，IOS下报支付错误问题
错误原因：微信分享链接上，微信会加参数(例如：?from=timeline&isappinstalled=0)，导致URL问题
解决方案：进入页面后，拿到微信带的参数，在URL字符串里替换调这些参数，然后重定向即可
```js
    // 解决微信分享带from=singlemessage 导致支付问题
    let url=window.location.href,bool=false;
    if(url.indexOf('?from=timeline')!=-1){
      bool=true;
      url=qs.url_format(url,'?from=timeline');
    }else if(url.indexOf('?from=groupmessage')!=-1){
      bool=true;
      url=qs.url_format(url,'?from=groupmessage');
    }else if(url.indexOf('?from=singlemessage')!=-1){
      bool=true;
      url=qs.url_format(url,'?from=singlemessage');
    }
    if(url.indexOf('&isappinstalled=0')!=-1){
      bool=true;
      url=qs.url_format(url,'&isappinstalled=0');
    }
    if(bool){
      window.location.href=url;
    }
```

##微信内置的浏览器是什么
	来源：https://blog.csdn.net/tim_yip/article/details/43466451

	微信内置的浏览器内核是QQ浏览器5.4的内核，手机QQ浏览器从版本4.0开始就使用了自主研发的X5内核

	如果你的微信版本是6.1以下，微信会调用系统自带的浏览器去加载渲染网页；
	如果你的微信版本是6.1以上，并且手机装有QQ浏览器，微信就会调用QQ浏览器的X5内核去加载渲染网页。